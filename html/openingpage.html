<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<title>SmartUI Opening Page</title>
	<!-- âœ… External stylesheet. Make changes to the fonts and style for project in that file -->
<link rel="stylesheet" href="../styles/styles.css" />
<style>
    body {
      margin: 0;
      padding: 0;
    }
    #wrapper {
      position: relative;
      width: 1920px;
      height: 1215px;
      background: url('../images/openingpage.png') no-repeat top left;
      background-size: cover;
    }
 
    .link-area {
      position: absolute;
      width: 100px;
      height: 20px;
      cursor: pointer;
    }
  </style>
</head>
<body>
<div id="wrapper">
<!-- Left side fields from core-input-fields.html inject here -->
	
<!-- Top Bar Link Areas -->
<a class="link-area" href="openingpage.html" style="top: 69px; left: 524px; height:18px; width:130px"></a>
<a class="link-area" href="BSRinformation.html" style="top: 69px; left: 660px; height:18px; width:100px"></a>
<a class="link-area" href="meterreads.html" style="top: 69px; left: 766px; height:18px; width:146px"></a>
<a class="link-area" href="prepaymentsettings.html" style="top: 69px; left: 918px; height:18px; width:125px"></a>
<a class="link-area" href="prepaymentpayments.html" style="top: 69px; left: 1049px; height:18px; width:133px"></a>
<a class="link-area" href="additionalfunctions.html" style="top: 69px; left: 1189px; height:18px; width:119px"></a>
<a class="link-area" href="diagnostics.html" style="top: 69px; left: 1313px; height:18px; width:76px"></a>
<a class="link-area" href="enhancedprepaymentservice.html" style="top: 69px; left: 1394px; height:18px; width:183px"></a>
</div>
	<script>
  window.addEventListener('DOMContentLoaded', () => {
    // Step 1: Inject fields
    fetch("../fragments/core-input-fields.html")
      .then(res => res.text())
      .then(html => {
        document.getElementById("wrapper").insertAdjacentHTML("beforeend", html);
      })
      .then(() => {
        // Step 2: After fields are injected, load scenario data
        const urlParams = new URLSearchParams(window.location.search);
        const scenario = urlParams.get("scenario");

        if (scenario) {
          fetch(scenario)
            .then(response => response.json())
            .then(data => {
              // Populate fields once available
              document.getElementById('contract_Account').value = data.contract_Account;
              document.getElementById('contract').value = data.contract;
              document.getElementById('contract_Start').value = data.contract_Start;
              document.getElementById('operating_Mode').value = data.operating_Mode;
              document.getElementById('payment_Plan').value = data.payment_Plan;
              document.getElementById('read_Retrieval').value = data.read_Retrieval;
              document.getElementById('last_Comm').value = data.last_Comm;
              document.getElementById('pod').value = data.pod;
              document.getElementById('device_Guid').value = data.device_Guid;
              document.getElementById('meter_Serial').value = data.meter_Serial;
              document.getElementById('device_Start').value = data.device_Start;
              document.getElementById('device_End').value = data.device_End;
              document.getElementById('device_Status').value = data.device_Status;
              document.getElementById('elecOrGas').value = data.elecOrGas;
              document.getElementById('BPID').value = data.BPID;
              document.getElementById('full_Name').value = `${data.first_Name} ${data.last_Name}`;
              
              const addressParts = [];
              if (data.flatnumber) addressParts.push(`FLAT ${data.flatnumber.toUpperCase()}`);
              if (data.housenumber && data.street) {
                addressParts.push(`${data.housenumber.toUpperCase()} ${data.street.toUpperCase()}`);
              } else if (data.housenumber) {
                addressParts.push(data.housenumber.toUpperCase());
              } else if (data.street) {
                addressParts.push(data.street.toUpperCase());
              }
              if (data.city) addressParts.push(data.city.toUpperCase());
              if (data.postcode) addressParts.push(data.postcode.toUpperCase());

              const addressField = document.getElementById('full_address');
              if (addressField) {
                addressField.value = addressParts.join(', ');
              }
            })
            .catch(err => console.error("Error loading scenario:", err));
        }
      });
  });
</script>
</body>
</html>
